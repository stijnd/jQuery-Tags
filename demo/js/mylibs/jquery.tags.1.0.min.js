(function(c){c.fn.tags=function(g){var e={init:function(a){this.tags.settings=c.extend({},this.tags.defaults,a);return this.each(function(){var a=c(this);a.val("");e.setup(a)})},setup:function(a){if("function"==typeof a.autocomplete)if(a.$autocomplete=c('<input type="text" name="'+a.attr("name")+'_tags" id="'+a.attr("id")+'_tags" />'),a.list_element=c('<div class="tag-list"><ul></ul></div>'),a.after(a.$autocomplete,a.list_element),c("label[for="+a.attr("id")+"]").attr("for",a.attr("id")+"_tags"),
a.hide(),void 0!==typeof a.tags.settings.data){var b=a.tags.settings.data,d=a.tags.settings.min_length;a.tag_items=[];a.$autocomplete.autocomplete({source:b,min_length:d,select:function(b,d){var f=!1;c.each(a.tag_items,function(){this.label==d.item.label&&this.value==d.item.value&&(f=!0)});!1==f&&(a.tag_items.push(d.item),e.add_item_to_dom(a,d.item.label),e.refill_textbox(a),!1==a.tags.settings.keep_tags&&a.$autocomplete.autocomplete("option").source.splice(a.$autocomplete.autocomplete("option").source.indexOf(d.item.label),
1),"function"==typeof a.tags.settings.tag_added&&a.tags.settings.tag_added());a.$autocomplete.val("").focus();return!1}});a.$autocomplete.unbind("keypress").keypress(function(b){if("13"==(b.keyCode?b.keyCode:b.which)){var d=!1,f=c(this).val();c.each(a.tag_items,function(){if(""+this.label.toLowerCase()==f.toLowerCase()||""+this.value.toLowerCase()==f.toLowerCase())d=!0});""!=f&&!1==d&&(e.add_item_to_dom(a,f),a.tag_items.push({value:f,label:f}),e.refill_textbox(a),a.$autocomplete.val("").focus(),"function"==
typeof a.tags.settings.tag_added&&a.tags.settings.tag_added(),"function"==typeof a.tags.settings.new_tag_added&&a.tags.settings.new_tag_added(f));return!1}})}else!0===a.tags.settings.debug&&c.error("There was no data-source added to the settings - read the documentation on how to fix this.");else c.error("Jquery ui's autocomplete is not available.")},remove_list_item:function(a,b){var d=0,h=-1;c.each(b.tag_items,function(){this.value==a.attr("data-value")&&(h=d);d++});b.tag_items.splice(h,1);e.refill_textbox(b);
b.$autocomplete.autocomplete("option").source.push(a.parent().children(".label").text());"function"==typeof b.tags.settings.tag_removed&&b.tags.settings.tag_removed(a.attr("data-value"));""!=b.tags.settings.animation_out?a.parent("li").hide(b.tags.settings.animation_out,b.tags.settings.animation_out_options,b.tags.settings.animation_out_speed,function(){c(this).remove()}):a.parent("li").remove()},refill_textbox:function(a){var b="";c.each(a.tag_items,function(a,c){b=0==a?b+c.label:b+(","+c.label)});
a.val(b)},add_item_to_dom:function(a,b){var d=c('<li><a href="#" class="remove" data-value="'+b+'" data-index="'+a.tag_items.length+'">x</a><span class="label">'+b+"</span></li>");c("a",d).click(function(b){b.preventDefault();e.remove_list_item(c(this),a)});""!=a.tags.settings.animation_in?(d.hide(),c("ul",a.list_element).append(d),d.show(a.tags.settings.animation_in,a.tags.settings.animation_in_options,a.tags.settings.animation_in_speed)):c("ul",a.list_element).append(d)}};if(e[g])return e[g].apply(this,
Array.prototype.slice.call(arguments,1));if("object"===typeof g||!g)return e.init.apply(this,arguments);c.error('Method "'+g+'" does not exist in pluginName plugin!')};c.fn.tags.defaults={debug:!1,min_length:2,animation_in:"",animation_in_options:{},animation_in_speed:0,animation_out:"",animation_out_options:{},animation_out_speed:0,keep_tags:!1,tag_added:null,new_tag_added:null};c.fn.tags.settings={}})(jQuery);