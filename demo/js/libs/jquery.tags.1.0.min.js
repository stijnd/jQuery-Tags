(function(b){b.fn.tags=function(h){var g={init:function(a){this.tags.settings=b.extend({},this.tags.defaults,a);return this.each(function(){var a=b(this);a.val("");g.setup(a)})},setup:function(a){if("function"==typeof a.autocomplete)if(a.$autocomplete=b('<input type="text" name="'+a.attr("name")+'_tags" id="'+a.attr("id")+'_tags" />'),a.list_element=b('<div class="tag-list"><ul></ul></div>'),a.after(a.$autocomplete,a.list_element),b("label[for="+a.attr("id")+"]").attr("for",a.attr("id")+"_tags"),
a.hide(),void 0!==typeof a.tags.settings.data){var c=a.tags.settings.data,i=a.tags.settings.min_length;a.tag_items=[];a.$autocomplete.autocomplete({source:c,min_length:i,select:function(c,e){var f=!1;b.each(a.tag_items,function(){this.label==e.item.label&&this.value==e.item.value&&(f=!0)});if(!1==f){var i=b('<li><a href="#" class="remove" data-value="'+e.item.value+'" data-index="'+a.tag_items.length+'">x</a><span class="label">'+e.item.label+"</span></li>");b("a",i).click(function(d){d.preventDefault();
g.remove_list_item(b(this),a)});a.tag_items.push(e.item);b("ul",a.list_element).append(i);g.refill_textbox(a);d.debug("index of element: "+a.$autocomplete.autocomplete("option").source.indexOf(e.item.label));d.debug("in this list: ");d.debug(a.$autocomplete.autocomplete("option").source);a.$autocomplete.autocomplete("option").source.splice(a.$autocomplete.autocomplete("option").source.indexOf(e.item.label),1);d.debug("Value of original field: "+a.val());d.debug("Added: "+e.item.value+" => "+e.item.label+
" to the following element: ");d.debug(b("ul",a.list_element));d.debug("Complete list of the selected tags: ");d.debug(a.tag_items)}else d.debug("This item is already in the list!");a.$autocomplete.val("").focus();return!1}});a.$autocomplete.unbind("keypress").keypress(function(c){if("13"==(c.keyCode?c.keyCode:c.which)){var e=!1,f=b(this).val();b.each(a.tag_items,function(){if(""+this.label.toLowerCase()==f.toLowerCase()||""+this.value.toLowerCase()==f.toLowerCase())e=!0});""!=f&&!1==e&&(c=b('<li><a href="#" class="remove" data-value="'+
f+'" data-index="'+a.tag_items.length+'">x</a><span class="label">'+f+"</span></li>"),b("a",c).click(function(c){c.preventDefault();g.remove_list_item(b(this),a)}),a.tag_items.push({value:f,label:f}),b("ul",a.list_element).append(c),g.refill_textbox(a),d.debug("Value of original field: "+a.val()),d.debug("Added: "+f+" => "+f+" to the following element: "),d.debug(b("ul",a.list_element)),d.debug("Complete list of the selected tags: "),d.debug(a.tag_items),a.$autocomplete.val("").focus());return!1}})}else!0===
a.tags.settings.debug&&b.error("There was no data-source added to the settings - read the documentation on how to fix this.");else b.error("Jquery ui's autocomplete is not available.")},remove_list_item:function(a,c){var i=0,h=-1;b.each(c.tag_items,function(){this.value==a.attr("data-value")&&(h=i);i++});c.tag_items.splice(h,1);g.refill_textbox(c);c.$autocomplete.autocomplete("option").source.push(a.parent().children(".label").text());a.parent("li").remove();d.debug("Value of original field: "+c.val());
d.debug("Complete list of the selected tags: ");d.debug(c.tag_items)},refill_textbox:function(a){var c="";b.each(a.tag_items,function(a,b){c=0==a?c+b.label:c+(","+b.label)});a.val(c)}},d={debug:function(a){console&&!0===b(this).tags.settings.debug?console.log(a):!0===b(this).tags.settings.debug&&alert(a)}};if(g[h])return g[h].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof h||!h)return g.init.apply(this,arguments);b.error('Method "'+h+'" does not exist in pluginName plugin!')};
b.fn.tags.defaults={debug:!1,min_length:2};b.fn.tags.settings={}})(jQuery);